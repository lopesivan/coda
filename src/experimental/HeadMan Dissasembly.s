xNAME ViewP
::
  CK1
  BINT0
  ID x00E
;

*ROMPTR 151 C
xNAME StErr
::
  CK1
  DUPTYPEZINT?
  IT
  xI>R
  DUPTYPEHSTR?
  IT
  HXS>#
  DUPTYPEREAL?
  IT
  COERCE
  DUPTYPEBINT?
  ITE
  JstGETTHEMSG
  DO>STR
  $>grobCR
  ROMPTR B0 86
  BINT14
  BINT_131d
  MAKEGROB
  DUPUNROT
  #ZERO#ONE
  GROB!
  DUPUNROT
  BINT11
  BINT1
  GROB!
  Save16Patch_
  DUPUNROT
  ZEROZERO
  GROB!
  Rest16Patch_
  SetDA1Temp
  ERRBEEP
;

* ROMPTR 151 D
NULLNAME 00C
::
  ClrDA1IsStat
  BINT80
  BINT_131d
  MAKEGROB
  DUPUNROT
  ZEROZERO
  GROB!
  DUPZERO
  BINT16
  BINT_131d
  BINT80
  SUBGROB
  HARDBUFF
  ZEROZERO
  GROB!
  Rest16Patch_
  SetDAsNoCh
;

NULLNAME 00E
::
  DUP1LAMBIND
  ::
    #0=case
    ::
      ZEROZERO
      ZEROZERO
    ;
    DUPTYPECSTR?
    NcaseTYPEERR
    BINT1
    PushVStack&KeepDROP
    CkChr00
    ?SKIP
    ROMPTR 151 D
    DUPTYPECSTR?
    NcaseTYPEERR
    SEP$NL
    SWAP
    DUPNULL$?
    caseSIZEERR
    "       Headman
         Read"
    $>GROBCR
    ROMPTR 151 C
    BEGIN
    DUP
    1GETLAM
    BINT13
    FPTR 3 9B
    BINT13
    #<
    1LAMBIND
    DUPUNROT
    LEN$
    #2+
    LAST$
    1GETABND
    UNTIL
    DROP
    DUPNULL$?
    IT
    DROP
    DEPTH
    reversym
    #1-
    Save16Patch_
    TRUE
  ;
  ONEONE
  ZEROZERO
  ZEROZERO
  '
  ::
    7GETLAM
    4GETLAM
    3GETLAM
    2DUP
    BINT80
    #+SWAP
    BINT_131d
    #+SWAP
    SUBGROB
    ROMPTR 151 C
  ;
  %3
  TRUE
  BINT12
  NDUPN
  DOBIND
  SaveSysFlags
  BINT81
  ClrSysFlag
  BINT70
  SetSysFlag
  BEGIN
  9GETLAM
  IT
  ::
    10GETLAM
    Rest16Patch_
    "Page"
    BINT42
    BINT28
    'DROPFALSE
    BINT61
    BINT26
    BINT28
    BINT9
    BINT12
    MINUSONE
    2REAL
    NULL$
    11GETLAM
    #1+_ONE_DO
    INDEX@
    #>$
    ONE{}N
    LOOP
    11GETLAM
    {}N
    2REAL
    8GETLAM
    #>$
    ONE{}N
    DUPONE
    ONEFALSE
    9PUTLAM
    'DROPFALSE
    12GETLAM
    DoInputForm
    NOT?SEMI
    CARCOMP
    DOSTR>
    CKREAL
    COERCE
    8PUTLAM
  ;
  8GETLAM
  PICK
  DUPNULL{}?
  IT
  DO>STR
  ::
    dLISTcase
    ::
      INNERCOMP
      NULLPAINT_
      SWAP
      #1+_ONE_DO
      ISTOP-INDEX
      #1+ROLL
      DUPTYPEGROB?
      ?SKIP
      ::
        DUP
        FPTR 4 1F
        #0=case
        ROTROT2DROP
        DROP
        %1
        PTR 2EF64
      ;
      FPTR 7 BF
      LOOP
    ;
    DUPTYPEGROB?
    ?SEMI
    1GETLAM
    DUP
    %3
    %=
    casedrop
    ::
      DUP
      FPTR 4 1F
      #0=case
      ROTROT2DROP
      DROP
      %1
      PTR 2EF64
    ;
    PTR 2EF64
  ;
  TURNMENUOFF
  DUPGROBDIM
  ZEROZERO
  3PUTLAM
  4PUTLAM
  5PUTLAM
  6PUTLAM
  7PUTLAM
  2GETEVAL
  BEGIN
  TRUE
  WaitForKey
  #3=
  ITE
  BINT80
  BINT0
  #+
  ::
    BINT16
    #=casedrop
    ::
      REPEATER
      BINT16
      ::
        4GETLAM
        BINT_131d
        #+
        5GETLAM
        #<
        NOT?SEMI
        4GETLAM
        #2+
        4PUTLAM
        2GETEVAL
      ;
    ;
    BINT15
    #=casedrop
    ::
      REPEATER
      BINT15
      ::
        3GETLAM
        BINT80
        #+
        6GETLAM
        #<
        NOT?SEMI
        3GETLAM
        #2+
        3PUTLAM
        2GETEVAL
      ;
    ;
    BINT14
    #=casedrop
    ::
      REPEATER
      BINT14
      ::
        4GETLAM
        #0=?SEMI
        4GETLAM
        #2-
        4PUTLAM
        2GETEVAL
      ;
    ;
    BINT10
    #=casedrop
    ::
      REPEATER
      BINT10
      ::
        3GETLAM
        #0=?SEMI
        3GETLAM
        #2-
        3PUTLAM
        2GETEVAL
      ;
    ;
    BINT41
    #=casedrop
    ::
      14GETLAM
      #0=case
      DoBadKey
      DROPFALSE
      REPEATER
      BINT41
      ::
        8GETLAM
        #1<>
        NOT?SEMI
        8GETLAM
        #1-
        8PUTLAM
        BINT9
        Blank$
        8GETLAM
        #>$
        tok/_
        11GETLAM
        #>$
        &$
        &$
        &$
        DISPSTATUS2
      ;
    ;
    BINT46
    #=casedrop
    ::
      14GETLAM
      #0=case
      DoBadKey
      DROPFALSE
      REPEATER
      BINT46
      ::
        8GETLAM
        11GETLAM
        #<>
        NOT?SEMI
        8GETLAM
        #1+
        8PUTLAM
        BINT9
        Blank$
        8GETLAM
        #>$
        tok/_
        11GETLAM
        #>$
        &$
        &$
        &$
        DISPSTATUS2
      ;
    ;
    BINT95
    #=casedrop
    ::
      6GETLAM
      BINT80
      2DUP#<
      case2DROP
      #-
      #2/
      #2*
      #2+
      3PUTLAM
      2GETEVAL
    ;
    BINT96
    #=casedrop
    ::
      5GETLAM
      BINT_131d
      2DUP#<
      case2DROP
      #-
      #2/
      #2*
      #2+
      4PUTLAM
      2GETEVAL
    ;
    BINT51
    #=casedrop
    ::
      14GETLAM
      #0=case
      DoBadKey
      9PUTLAM
      FALSE
    ;
    BINT94
    #=casedrop
    ::
      BINT0
      4PUTLAM
      2GETEVAL
    ;
    BINT90
    #=casedrop
    ::
      BINT0
      3PUTLAM
      2GETEVAL
    ;
    BINT47
    #=casedrop
    ::
      14GETLAM
      #0=ITE
      BINT0
      11GETLAM
      NDROP
      DROPFALSE
      DUP1PUTLAM_
    ;
    BINT50
    #=casedrop
    ::
      DROPFALSE
      1GETLAM
      %1+
      %4
      %MOD
      1PUTLAM
    ;
    BINT127
    #=casedrop
    TurnOff
    DropBadKey
  ;
  NOT_UNTIL
  1GETLAM
  NOT_UNTIL
  ABND
  ABND
  RestoreSysFlags
  PopVStackAbove
  DispStatus
;
